<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>ãƒ©ãƒ³ã‚­ãƒ³ã‚°</title>
<style>
html,body{height:100%;margin:0;padding:0;overflow-x:hidden}
body{font-family:Arial;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;padding:20px;box-sizing:border-box;position:relative}
.container{max-width:1200px;margin:0 auto}
h1{text-align:center;color:#fff;margin-bottom:30px}
table{width:100%;background:#fff;border-radius:12px;overflow:hidden;border-collapse:collapse}
th,td{padding:15px;text-align:center}
th{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}
tr:nth-child(even){background:#f8f9fa}
.rank-1{color:#FFD700;font-weight:bold}
.rank-2{color:#C0C0C0;font-weight:bold}
.rank-3{color:#CD7F32;font-weight:bold}
</style>
</head>
<body>
<div class="container">
<h1>ğŸ† AIç­‹ãƒˆãƒ¬RPG ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h1>
<table>
<thead>
<tr><th>é †ä½</th><th>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å</th><th>ã‚¹ãƒ†ãƒ¼ã‚¸</th><th>ã‚¹ã‚¯ãƒ¯ãƒƒãƒˆå›æ•°</th><th>ãƒ¡ãƒ¼ãƒ«</th><th>æ—¥æ™‚</th></tr>
</thead>
<tbody id="ranking">
<tr><td colspan="6">èª­ã¿è¾¼ã¿ä¸­...</td></tr>
</tbody>
</table>
</div>
<script>
function formatDate(d){const dt=new Date(d);return (dt.getMonth()+1)+'/'+ dt.getDate()+' '+dt.getHours()+':'+String(dt.getMinutes()).padStart(2,'0')}
function render(data){
const tbody=document.getElementById('ranking');
if(!data||data.length===0){
tbody.innerHTML='<tr><td colspan="6">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
return;
}
let html='';
data.forEach((item,i)=>{
const rank=i+1;
let rankClass='';
if(rank===1)rankClass='rank-1';
else if(rank===2)rankClass='rank-2';
else if(rank===3)rankClass='rank-3';
html+=`<tr><td class="${rankClass}">${rank}</td><td>${item.name}</td><td><strong>${item.stage}</strong></td><td>${item.squats}</td><td style="font-size:0.85em">${item.email}</td><td>${formatDate(item.date)}</td></tr>`;
});
tbody.innerHTML=html;
}
if(typeof google!=='undefined'&&google.script&&google.script.run){
google.script.run.withSuccessHandler(render).withFailureHandler(()=>render([])).getStageRanking();
}else{
render([]);
}
</script>
</body>
</html>
