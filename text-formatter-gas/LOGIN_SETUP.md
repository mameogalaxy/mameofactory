# ログイン機能の有効化手順

現在、ゲームは**匿名アクセス**で動作しています。
Googleログイン機能を有効化するには、以下の手順が必要です。

## 方法1: 2つのデプロイを作成（推奨）

### 手順

1. **GASエディタを開く**
   ```
   clasp open
   ```

2. **新しいデプロイを作成**
   - 右上の「デプロイ」→「新しいデプロイ」
   - 種類: ウェブアプリ
   - 説明: 「ログイン必須版」
   - 次のユーザーとして実行: **アクセスしているユーザー**
   - アクセスできるユーザー: **全員**
   - デプロイ

3. **2つのURLを取得**
   - 匿名版URL: 既存のデプロイ（ANYONE_ANONYMOUS）
   - ログイン版URL: 新しいデプロイ（USER_ACCESSING）

4. **ログインボタンの動作**
   - ログインボタンをクリック → ログイン版URLを開く
   - Googleアカウントで認証
   - 認証後、ユーザー情報がスプレッドシートに保存

## 方法2: 現在のデプロイを変更（非推奨）

### appsscript.jsonを変更
```json
{
  "webapp": {
    "executeAs": "USER_ACCESSING",
    "access": "ANYONE"
  }
}
```

### デメリット
- 全ユーザーがログイン必須になる
- 匿名プレイができなくなる

## 現在の状態

- ✅ 匿名ユーザーも遊べる
- ✅ ログインボタンは表示される
- ❌ ログイン機能は未実装（上記手順が必要）
- ✅ 将来の拡張に対応済み

## ログイン後の特典（実装済み）

1. **ユーザーシートに登録**
   - メールアドレス
   - 登録日時
   - 最終プレイ日時
   - 総プレイ回数
   - 最高ステージ

2. **スコア保存時にメールアドレスを記録**

3. **将来の拡張**
   - ログインユーザー限定の敵
   - 特別なアイテム
   - プレゼント機能
   - 個人ランキング

## 推奨設定

**方法1（2つのデプロイ）**を推奨します。
- 匿名ユーザーも遊べる
- ログインユーザーには特典を提供
- 柔軟な運用が可能
